<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Episode 8: Streaming Systems & Kafka | Season Finale</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/black.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/monokai.min.css">
    <style>
        :root {
            --r-background-color: #0a0a0a;
            --r-main-font: 'Segoe UI', system-ui, sans-serif;
            --r-main-font-size: 28px;
            --r-main-color: #e0e0e0;
            --r-heading-color: #ffffff;
            --r-link-color: #4fc3f7;
            --r-selection-background-color: #4fc3f7;
            --r-code-font: 'Fira Code', 'Cascadia Code', monospace;
        }
        
        .reveal { font-size: var(--r-main-font-size); }
        .reveal h1 { font-size: 1.8em; color: #4fc3f7; text-shadow: 0 0 30px rgba(79, 195, 247, 0.5); }
        .reveal h2 { font-size: 1.4em; color: #81d4fa; }
        .reveal h3 { font-size: 1.15em; color: #b3e5fc; }
        
        .reveal pre { 
            width: 100%; 
            font-size: 0.7em;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            border-radius: 8px;
            border: 1px solid #333;
        }
        .reveal pre code {
            max-height: 520px;
            padding: 20px;
            line-height: 1.4;
            background: #1a1a2e;
        }
        
        .disaster-box {
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1515 100%);
            border: 2px solid #ff4444;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 30px rgba(255, 68, 68, 0.3);
        }
        
        .concept-box {
            background: linear-gradient(135deg, #0a1a2a 0%, #0d2137 100%);
            border: 2px solid #4fc3f7;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 30px rgba(79, 195, 247, 0.2);
        }
        
        .success-box {
            background: linear-gradient(135deg, #0a1a0a 0%, #153d15 100%);
            border: 2px solid #4caf50;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 30px rgba(76, 175, 80, 0.2);
        }
        
        .revelation-box {
            background: linear-gradient(135deg, #1a1a0a 0%, #3d3d15 100%);
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        
        .finale-box {
            background: linear-gradient(135deg, #1a0a1a 0%, #2d152d 100%);
            border: 2px solid #ba68c8;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 30px rgba(186, 104, 200, 0.3);
        }
        
        .ascii-diagram {
            font-family: 'Fira Code', 'Cascadia Code', monospace;
            font-size: 0.55em;
            line-height: 1.3;
            text-align: left;
            background: #0d1117;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #30363d;
            white-space: pre;
            overflow-x: auto;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .grid-item {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .emoji-large { font-size: 1.5em; }
        .text-red { color: #ff6b6b; }
        .text-green { color: #69f0ae; }
        .text-yellow { color: #ffd54f; }
        .text-blue { color: #4fc3f7; }
        .text-purple { color: #ba68c8; }
        
        .badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: bold;
            margin: 5px;
        }
        .badge-finale { background: linear-gradient(90deg, #9c27b0, #e91e63); }
        .badge-act { background: #1565c0; }
        
        .timeline-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #4fc3f7;
            background: rgba(79, 195, 247, 0.1);
        }
        
        .key-insight {
            background: linear-gradient(90deg, rgba(255,215,0,0.2), rgba(255,215,0,0.05));
            border-left: 4px solid #ffd700;
            padding: 15px 20px;
            margin: 15px 0;
            font-style: italic;
        }
        
        .season-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(90deg, #9c27b0, #e91e63);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.6em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .decision-matrix {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.65em;
            margin: 15px 0;
        }
        .decision-matrix th, .decision-matrix td {
            border: 1px solid #444;
            padding: 12px;
            text-align: left;
        }
        .decision-matrix th {
            background: #1a237e;
            color: #fff;
        }
        .decision-matrix tr:nth-child(even) {
            background: rgba(255,255,255,0.05);
        }
        
        .achievement {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            margin: 8px 0;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 8px;
            border-left: 3px solid #4caf50;
            font-size: 0.85em;
        }
        
        .git-link {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 16px;
            background: #24292e;
            border-radius: 6px;
            font-size: 0.6em;
            color: #58a6ff;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            
            <!-- ==================== SLIDE 1: TITLE ==================== -->
            <section>
                <div class="season-badge">ğŸ¬ SEASON FINALE</div>
                <h1>Episode 8</h1>
                <h2>Streaming Systems & Kafka</h2>
                <p style="color: #888; margin-top: 30px;">From Video Buffers to Distributed Logs</p>
                <div style="margin-top: 40px;">
                    <span class="badge badge-finale">SEASON 1: THE INVISIBLE LINKED LIST</span>
                </div>
                <p style="color: #666; font-size: 0.7em; margin-top: 40px;">
                    The patterns you learned... now at planet scale
                </p>
            </section>

            <!-- ==================== ACT 1: WHY IS MY VIDEO CHOPPY? ==================== -->
            <section>
                <section>
                    <span class="badge badge-act">ACT 1</span>
                    <h1>Why Is My Video Choppy?</h1>
                    <p class="text-red" style="font-size: 1.2em;">ğŸ˜¤ We've ALL been here...</p>
                </section>

                <!-- SLIDE 2: THE DISASTER -->
                <section>
                    <h2 class="text-red">The Worst Video Call Ever</h2>
                    <div class="disaster-box">
                        <div class="ascii-diagram">
ğŸ‘¤ "Hi everyone, let me share myâ€”"

    [FREEZE]

ğŸ‘¤ "â€”reen. Can you see my screen?"

    [CHOPPY AUDIO: "The... de...line... is... Fri..."]

    [VIDEO FREEZES ON UNFLATTERING EXPRESSION]

ğŸ‘¤ "Sorry, my internet isâ€”"

    [CALL DROPS]

    âš ï¸ "Reconnecting..."
                        </div>
                    </div>
                    <p class="fragment" style="font-size: 1.1em;">
                        <span class="emoji-large">ğŸ˜¤</span> Why does this KEEP happening?
                    </p>
                </section>

                <!-- SLIDE 3: THE HIDDEN ENEMY -->
                <section>
                    <h2>The Invisible Enemy: <span class="text-red">Network Jitter</span></h2>
                    <div class="concept-box">
                        <div class="ascii-diagram">
What your NETWORK delivers:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Time:     0ms   50ms   80ms   150ms   160ms   250ms
Frame:     1      2      3       4       5       6
           â””â”€50â”€â”€â”€â”´â”€30â”€â”€â”€â”´â”€â”€70â”€â”€â”€â”´â”€10â”€â”€â”€â”€â”´â”€â”€90â”€â”€â”˜
                  <span class="text-red">CHAOS (irregular gaps)</span>

What your EYES need:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Time:     0ms    33ms   66ms   100ms   133ms   166ms
Frame:     1      2      3       4       5       6
           â””â”€33â”€â”€â”€â”´â”€33â”€â”€â”€â”´â”€â”€33â”€â”€â”€â”´â”€33â”€â”€â”€â”€â”´â”€â”€33â”€â”€â”˜
                  <span class="text-green">SMOOTH (exactly 30 fps)</span>
                        </div>
                    </div>
                    <div class="key-insight fragment">
                        âš ï¸ THE GAP: Network = Chaos. Eyes = Steady.
                    </div>
                </section>

                <!-- SLIDE 4: WITHOUT A BUFFER -->
                <section>
                    <h2 class="text-red">Without a Buffer â€” Disaster</h2>
                    <div class="disaster-box">
                        <div class="ascii-diagram">
Time 0ms:   Frame 1 arrives â†’ âœ… Play it!
Time 33ms:  Need Frame 2... but it won't arrive til 50ms
            <span class="text-red">â¸ï¸ FREEZE! Nothing to show.</span>
Time 50ms:  Frame 2 arrives â†’ âœ… Play it (we're late!)
Time 66ms:  Need Frame 3... but it won't arrive til 80ms
            <span class="text-red">â¸ï¸ FREEZE AGAIN!</span>
Time 80ms:  Frame 3 arrives â†’ âœ… Play it
Time 100ms: Need Frame 4... but it won't arrive til 150ms
            <span class="text-red">â¸ï¸ LONG FREEZE! ğŸ˜±</span>

Result: ğŸ¬â¡ï¸â¸ï¸â¡ï¸ğŸ¬â¡ï¸â¸ï¸â¡ï¸ğŸ¬â¡ï¸â¸ï¸â¸ï¸â¸ï¸â¡ï¸ğŸ¬
                        </div>
                    </div>
                    <p class="fragment text-yellow">
                        This is WHY your video is choppy!
                    </p>
                </section>

                <!-- SLIDE 5: THE SOLUTION CONCEPT -->
                <section>
                    <h2 class="text-green">The Jitter Buffer â€” Your Shield</h2>
                    <div class="success-box">
                        <div class="ascii-diagram">
Network (chaos) â”€â”€â–º  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”€â”€â–º Eyes (smooth)
                     â”‚   BUFFER    â”‚
 Frames arrive       â”‚  â”Œâ”€â”¬â”€â”¬â”€â”¬â”€â”  â”‚       Frames leave
 at random times     â”‚  â”‚3â”‚4â”‚5â”‚6â”‚  â”‚       at steady 30fps
                     â”‚  â””â”€â”´â”€â”´â”€â”´â”€â”˜  â”‚
                     â”‚             â”‚
                     â”‚  Absorbs    â”‚
                     â”‚  the chaos  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                    <div class="fragment" style="margin-top: 20px;">
                        <p><strong>The SECRET:</strong></p>
                        <ul style="font-size: 0.85em;">
                            <li>Wait for a few frames to accumulate (~100ms buffer)</li>
                            <li>Now you have <span class="text-green">RUNWAY</span> to absorb jitter</li>
                            <li>Network hiccup? No problem â€” play from buffer</li>
                        </ul>
                    </div>
                    <div class="key-insight fragment">
                        Trade-off: 100ms extra latency â†’ MUCH smoother video
                    </div>
                </section>

                <!-- SLIDE 6: THE CODE -->
                <section>
                    <h2>The Core Code</h2>
                    <pre><code class="language-python">class JitterBuffer:
    """The shield between network chaos and smooth playback."""
    
    def __init__(self):
        self.buffer = RingBuffer(capacity=10)  # â† Episode 7!
        self.playback_started = False
    
    def receive_frame(self, frame):
        self.buffer.push(frame)
        if self.buffer.size >= 3:  # 100ms cushion
            self.playback_started = True
    
    def get_next_frame(self):
        if not self.playback_started:
            return None  # "Buffering..."
        return self.buffer.pop()</code></pre>
                    <div class="key-insight">
                        ğŸ’¡ This IS a ring buffer from Episode 7! Same pattern. New problem.
                    </div>
                    <div class="git-link">ğŸ“‚ github.com/[repo]/episode8/jitter_buffer.py</div>
                </section>

                <!-- SLIDE 7: TRIPLE BUFFERING -->
                <section>
                    <h2>Triple Buffering â€” Inside YouTube/Netflix</h2>
                    <div class="concept-box">
                        <div class="ascii-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   NETWORK    â”‚    â”‚    DECODE    â”‚    â”‚    RENDER    â”‚
â”‚    BUFFER    â”‚ â”€â–º â”‚    BUFFER    â”‚ â”€â–º â”‚    BUFFER    â”‚
â”‚              â”‚    â”‚              â”‚    â”‚              â”‚
â”‚ Raw packets  â”‚    â”‚ Decoded      â”‚    â”‚ Ready to     â”‚
â”‚ from CDN     â”‚    â”‚ video frames â”‚    â”‚ display      â”‚
â”‚              â”‚    â”‚              â”‚    â”‚              â”‚
â”‚ [100 slots]  â”‚    â”‚ [30 slots]   â”‚    â”‚ [3 slots]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Thread 1:           Thread 2:           Thread 3:
Receive from        Decompress          Display at
network             H.264 â†’ pixels      60 fps exactly
                        </div>
                    </div>
                    <p class="fragment" style="font-size: 0.8em;">
                        <span class="text-blue">WHY THREE?</span> Each stage runs at different speeds. 
                        Buffers <strong>DECOUPLE</strong> the stages.
                    </p>
                    <p class="fragment" style="font-size: 0.7em; color: #888;">
                        ğŸ¬ Used by: YouTube, Netflix, Zoom, Twitch, Disney+
                    </p>
                </section>
            </section>

            <!-- ==================== ACT 2: HOW DOES KAFKA HANDLE TRILLIONS? ==================== -->
            <section>
                <section>
                    <span class="badge badge-act">ACT 2</span>
                    <h1>How Does Kafka Handle Trillions?</h1>
                    <p class="text-blue" style="font-size: 1.2em;">ğŸ¤¯ The revelation...</p>
                </section>

                <!-- SLIDE 8: SCALE FAILURE -->
                <section>
                    <h2 class="text-red">The Day LinkedIn Broke</h2>
                    <div class="disaster-box">
                        <div class="ascii-diagram">
ğŸ“Š LinkedIn in 2011:
â€¢ 175 million messages per day
â€¢ One message queue server

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SERVER                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚       MESSAGE QUEUE            â”‚    â”‚
â”‚  â”‚  [FULL] [FULL] [FULL] [FULL]  â”‚    â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚    â”‚
â”‚  â”‚         <span class="text-red">100% FULL</span>             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                        â”‚
â”‚  ğŸ’€ Memory: 100%   CPU: 100%          â”‚
â”‚  <span class="text-red">ğŸ”¥ CRASH IMMINENT</span>                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                    <p class="fragment text-red">
                        âŒ ONE server cannot handle internet-scale data
                    </p>
                </section>

                <!-- SLIDE 9: THE BIG REVEAL -->
                <section>
                    <h2 class="text-yellow">ğŸ¤¯ The Big Reveal</h2>
                    <div class="revelation-box">
                        <div class="comparison-grid">
                            <div class="grid-item">
                                <h3 class="text-blue">EPISODE 7<br>Ring Buffer</h3>
                                <div class="ascii-diagram" style="font-size: 0.8em;">
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ A â”‚ B â”‚ C â”‚ D â”‚   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  â†‘           â†‘
 tail       head
(reader)  (writer)
                                </div>
                            </div>
                            <div class="grid-item">
                                <h3 class="text-green">KAFKA<br>Partition</h3>
                                <div class="ascii-diagram" style="font-size: 0.8em;">
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ A â”‚ B â”‚ C â”‚ D â”‚   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  â†‘           â†‘
 read       write
offset     offset
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 20px; font-size: 0.8em;">
                            <p>â€¢ Fixed capacity â†’ Retention policy</p>
                            <p>â€¢ Wrap around â†’ Delete old segments</p>
                            <p>â€¢ Single reader â†’ <span class="text-green">MULTIPLE readers!</span></p>
                        </div>
                    </div>
                    <div class="key-insight fragment">
                        ğŸ’¡ KAFKA IS RING BUFFERS DISTRIBUTED ACROSS THE PLANET
                    </div>
                </section>

                <!-- SLIDE 10: PARTITIONS -->
                <section>
                    <h2>Partitions â€” Divide to Conquer</h2>
                    <div class="concept-box">
                        <div class="ascii-diagram">
ONE QUEUE (Episode 7):          PARTITIONED (Kafka):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” Partition 0
â”‚ ALL MESSAGES       â”‚          â”‚ User A  â”‚ â† Server 1
â”‚ User A, B, C, D... â”‚   â”€â”€â–º    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ <span class="text-red">ğŸ”¥ BOTTLENECK</span>     â”‚          â”‚ User B  â”‚ Partition 1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ User D  â”‚ â† Server 2
                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                â”‚ User C  â”‚ Partition 2
                                â”‚         â”‚ â† Server 3
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                    <pre class="fragment"><code class="language-python">def get_partition(key, num_partitions=12):
    # Consistent hashing from Episode 6!
    return hash(key) % num_partitions

# User A's messages â†’ always Partition 3
# User B's messages â†’ always Partition 7
# Parallel processing across all partitions!</code></pre>
                    <div class="git-link">ğŸ“‚ github.com/[repo]/episode8/kafka_partitioner.py</div>
                </section>

                <!-- SLIDE 11: CONSUMER GROUPS -->
                <section>
                    <h2>Consumer Groups â€” Multiple Readers</h2>
                    <div class="concept-box">
                        <div class="ascii-diagram">
RING BUFFER (Episode 7):        KAFKA:
ONE reader                      MANY independent readers

â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”          â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ A â”‚ B â”‚ C â”‚ D â”‚ E â”‚          â”‚ A â”‚ B â”‚ C â”‚ D â”‚ E â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜          â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
      â†‘                              â†‘   â†‘       â†‘
    reader                      Analyticsâ”‚    Real-time
                               (offset 1)â”‚   (offset 4)
                                         â”‚
                                     Billing
                                    (offset 2)
                        </div>
                    </div>
                    <pre class="fragment"><code class="language-python"># Each consumer group tracks its OWN position
consumer_offsets = {
    'real-time-alerts': 99847,  # Latest
    'billing':          99102,  # Hourly  
    'analytics':        85000,  # Days behind - that's OK!
}

def consume(consumer_group):
    offset = consumer_offsets[consumer_group]
    messages = read_from(offset)
    consumer_offsets[consumer_group] += len(messages)
    return messages</code></pre>
                    <div class="git-link">ğŸ“‚ github.com/[repo]/episode8/kafka_consumer.py</div>
                </section>

                <!-- SLIDE 12: WHY KAFKA IS FAST -->
                <section>
                    <h2>Why Kafka Handles 7 Trillion Messages/Day</h2>
                    <div class="concept-box" style="font-size: 0.85em;">
                        <div class="comparison-grid">
                            <div class="grid-item">
                                <h3>1ï¸âƒ£ APPEND-ONLY</h3>
                                <p>Sequential: <span class="text-green">600 MB/s</span></p>
                                <p>Random: <span class="text-red">100 KB/s</span></p>
                                <p style="font-size: 0.8em;">6000Ã— faster!</p>
                            </div>
                            <div class="grid-item">
                                <h3>2ï¸âƒ£ ZERO-COPY</h3>
                                <p>Traditional: Diskâ†’Kernelâ†’Userâ†’Kernelâ†’Network</p>
                                <p>Zero-copy: Diskâ†’Kernelâ†’Network</p>
                                <p style="font-size: 0.8em;">Skip user space!</p>
                            </div>
                            <div class="grid-item">
                                <h3>3ï¸âƒ£ BATCHING</h3>
                                <p>Don't send 1000 tiny messages</p>
                                <p>Send ONE batch of 1000</p>
                                <p style="font-size: 0.8em;">Amortize overhead</p>
                            </div>
                            <div class="grid-item">
                                <h3>4ï¸âƒ£ PAGE CACHE</h3>
                                <p>Let the OS handle caching</p>
                                <p>It's really good at it</p>
                                <p style="font-size: 0.8em;">Don't reinvent</p>
                            </div>
                        </div>
                    </div>
                    <div class="key-insight fragment">
                        ğŸ’¡ No magic. Just smart engineering decisions.
                    </div>
                </section>
            </section>

            <!-- ==================== ACT 3: BACKPRESSURE ==================== -->
            <section>
                <section>
                    <span class="badge badge-act">ACT 3</span>
                    <h1>What Happens When We Can't Keep Up?</h1>
                    <p class="text-yellow" style="font-size: 1.2em;">âš–ï¸ Engineering judgment...</p>
                </section>

                <!-- SLIDE 13: BACKPRESSURE CRISIS -->
                <section>
                    <h2 class="text-red">The System Is Drowning</h2>
                    <div class="disaster-box">
                        <div class="ascii-diagram">
ğŸ“ˆ Producer: 10,000 messages/second
ğŸ“‰ Consumer: 8,000 messages/second
ğŸ“Š Gap: 2,000 messages/second accumulating

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BUFFER                              â”‚
â”‚  Hour 1:  <span class="text-yellow">â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span>  7.2 million backed up    â”‚
â”‚  Hour 6:  <span class="text-yellow">â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘</span>  43 million backed up     â”‚
â”‚  Hour 24: <span class="text-red">â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“</span>  172 million backed up    â”‚
â”‚                                                         â”‚
â”‚           <span class="text-red">ğŸ’€ OUT OF MEMORY â€” SYSTEM CRASH ğŸ’€</span>            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                    <div class="key-insight fragment">
                        âš ï¸ A 20% speed mismatch becomes a CATASTROPHE
                    </div>
                </section>

                <!-- SLIDE 14: DECISION MATRIX -->
                <section>
                    <h2>Backpressure Decision Matrix</h2>
                    <table class="decision-matrix">
                        <thead>
                            <tr>
                                <th>SCENARIO</th>
                                <th>STRATEGY</th>
                                <th>WHY?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ğŸ’° Financial transactions</td>
                                <td class="text-green">BLOCK</td>
                                <td>Can't lose a penny</td>
                            </tr>
                            <tr>
                                <td>ğŸ¬ Live video streaming</td>
                                <td class="text-yellow">DROP OLDEST</td>
                                <td>Stale frame = useless</td>
                            </tr>
                            <tr>
                                <td>ğŸ“Š Server metrics</td>
                                <td class="text-yellow">SAMPLE (10%)</td>
                                <td>Stats still valid</td>
                            </tr>
                            <tr>
                                <td>ğŸ“œ Audit logs</td>
                                <td class="text-green">BLOCK</td>
                                <td>Legal requirement</td>
                            </tr>
                            <tr>
                                <td>ğŸ“ˆ Stock tickers</td>
                                <td class="text-yellow">DROP OLDEST</td>
                                <td>Old price = wrong</td>
                            </tr>
                            <tr>
                                <td>ğŸ”” User notifications</td>
                                <td class="text-blue">BACKPRESSURE</td>
                                <td>Slow down sender</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="key-insight fragment">
                        ğŸ’¡ No "correct" default. This is ENGINEERING JUDGMENT based on data criticality.
                    </div>
                </section>

                <!-- SLIDE 15: FAILURE MODES -->
                <section>
                    <h2>âš ï¸ Streaming Failure Modes</h2>
                    <div class="comparison-grid" style="font-size: 0.85em;">
                        <div class="grid-item" style="border-left: 3px solid #ff6b6b;">
                            <h3 class="text-red">ğŸ”´ BUFFER BLOAT</h3>
                            <p>Memory grows until OOM</p>
                            <p><em>Monitor: Buffer utilization %</em></p>
                        </div>
                        <div class="grid-item" style="border-left: 3px solid #ff6b6b;">
                            <h3 class="text-red">ğŸ”´ CASCADING BACKPRESSURE</h3>
                            <p>One slow consumer slows entire pipeline</p>
                            <p><em>Monitor: Per-consumer throughput</em></p>
                        </div>
                        <div class="grid-item" style="border-left: 3px solid #ff6b6b;">
                            <h3 class="text-red">ğŸ”´ CONSUMER LAG</h3>
                            <p>Falling further behind... forever</p>
                            <p><em>Monitor: Offset behind head</em></p>
                        </div>
                        <div class="grid-item" style="border-left: 3px solid #ff6b6b;">
                            <h3 class="text-red">ğŸ”´ HEAD-OF-LINE BLOCKING</h3>
                            <p>One slow message blocks everything</p>
                            <p><em>Monitor: p99 latency vs p50</em></p>
                        </div>
                    </div>
                    <div class="key-insight fragment">
                        âš¡ Alert BEFORE it's critical!
                    </div>
                </section>
            </section>

            <!-- ==================== ACT 4: SEASON FINALE ==================== -->
            <section>
                <section>
                    <span class="badge badge-finale">SEASON FINALE</span>
                    <h1>What Did We Actually Learn?</h1>
                    <p class="text-purple" style="font-size: 1.2em;">ğŸ¬ The complete journey...</p>
                </section>

                <!-- SLIDE 16: COMPLETE JOURNEY -->
                <section>
                    <h2>Season 1 â€” The Complete Journey</h2>
                    <div class="finale-box" style="font-size: 0.7em;">
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 1</span>
                            <span>ğŸ“ "How do I store history?" â†’ <strong>Git Commits</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 2</span>
                            <span>ğŸ”€ "Where do two histories meet?" â†’ <strong>Git Merge-Base</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 3</span>
                            <span>â†”ï¸ "Can I go back AND forward?" â†’ <strong>Browser History</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 4</span>
                            <span>ğŸ“¸ "What if I need ALL states?" â†’ <strong>Redux, Time-Travel Debug</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 5</span>
                            <span>ğŸ§  "I can't remember everything" â†’ <strong>LRU Cache, Redis</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 6</span>
                            <span>ğŸŒ "One machine isn't enough" â†’ <strong>CDNs, Redis Cluster</strong></span>
                        </div>
                        <div class="timeline-item">
                            <span style="width: 80px;">Ep 7</span>
                            <span>âˆ "Data is infinite. Memory is not" â†’ <strong>Logging, Metrics</strong></span>
                        </div>
                        <div class="timeline-item" style="border-color: #ba68c8; background: rgba(186, 104, 200, 0.2);">
                            <span style="width: 80px;">Ep 8</span>
                            <span>ğŸŒ "Planet scale?" â†’ <strong>Kafka, YouTube, Netflix</strong></span>
                        </div>
                    </div>
                </section>

                <!-- SLIDE 17: THE BIG REVELATION -->
                <section>
                    <h2 class="text-yellow">The One Idea Behind It All</h2>
                    <div class="revelation-box" style="text-align: center;">
                        <h1 style="font-size: 2em; margin: 30px 0;">
                            <span class="text-yellow">TIME</span><br>
                            <span style="font-size: 0.5em; color: #888;">as a</span><br>
                            DATA STRUCTURE
                        </h1>
                    </div>
                    <div style="font-size: 0.8em; margin-top: 20px;">
                        <p class="fragment">Episode 1-2: <strong>STORE</strong> time (linear history)</p>
                        <p class="fragment">Episode 3: <strong>NAVIGATE</strong> time (back and forward)</p>
                        <p class="fragment">Episode 4: <strong>PRESERVE</strong> time (never lose a state)</p>
                        <p class="fragment">Episode 5: <strong>FORGET</strong> time intelligently (LRU)</p>
                        <p class="fragment">Episode 6: <strong>DISTRIBUTE</strong> time (across the globe)</p>
                        <p class="fragment">Episode 7-8: <strong>BOUND</strong> time (infinite â†’ finite)</p>
                    </div>
                </section>

                <!-- SLIDE 18: FIVE PRINCIPLES -->
                <section>
                    <h2>Five Engineering Principles</h2>
                    <div style="font-size: 0.75em; text-align: left;">
                        <div class="fragment" style="margin: 15px 0; padding: 10px; background: rgba(79, 195, 247, 0.1); border-radius: 8px;">
                            <strong>1ï¸âƒ£ Choose the right time representation</strong><br>
                            <span style="color: #888;">Forward-only? Singly-linked. Bidirectional? Doubly. Bounded? Ring.</span>
                        </div>
                        <div class="fragment" style="margin: 15px 0; padding: 10px; background: rgba(79, 195, 247, 0.1); border-radius: 8px;">
                            <strong>2ï¸âƒ£ Balance memory vs completeness</strong><br>
                            <span style="color: #888;">Can't keep everything. Decide what to forget. LRU for access, Ring for time.</span>
                        </div>
                        <div class="fragment" style="margin: 15px 0; padding: 10px; background: rgba(79, 195, 247, 0.1); border-radius: 8px;">
                            <strong>3ï¸âƒ£ Design for navigation patterns</strong><br>
                            <span style="color: #888;">Know your access patterns BEFORE choosing structure.</span>
                        </div>
                        <div class="fragment" style="margin: 15px 0; padding: 10px; background: rgba(79, 195, 247, 0.1); border-radius: 8px;">
                            <strong>4ï¸âƒ£ Plan for distribution from day one</strong><br>
                            <span style="color: #888;">Single machine patterns scale. Consistent hashing minimizes disruption.</span>
                        </div>
                        <div class="fragment" style="margin: 15px 0; padding: 10px; background: rgba(79, 195, 247, 0.1); border-radius: 8px;">
                            <strong>5ï¸âƒ£ Handle infinity gracefully</strong><br>
                            <span style="color: #888;">Infinite data needs bounded buffers. Backpressure is an engineering choice.</span>
                        </div>
                    </div>
                </section>

                <!-- SLIDE 19: QUICK REFERENCE -->
                <section>
                    <h2>Season 1 Quick Reference</h2>
                    <div class="concept-box">
                        <table class="decision-matrix" style="font-size: 0.6em;">
                            <thead>
                                <tr>
                                    <th>EP</th>
                                    <th>DATA STRUCTURE</th>
                                    <th>PRODUCTION USE</th>
                                    <th>KEY INSIGHT</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>1</td><td>Singly Linked</td><td>Git Commits</td><td>Store time</td></tr>
                                <tr><td>2</td><td>Intersection</td><td>Git Merge-Base</td><td>Find common</td></tr>
                                <tr><td>3</td><td>Doubly Linked</td><td>Browser History</td><td>Navigate both</td></tr>
                                <tr><td>4</td><td>Immutable</td><td>Redux/Undo</td><td>Preserve all</td></tr>
                                <tr><td>5</td><td>LRU Cache</td><td>Browser/Redis</td><td>Forget wisely</td></tr>
                                <tr><td>6</td><td>Consistent Hash</td><td>CDN/Cluster</td><td>Distribute</td></tr>
                                <tr><td>7</td><td>Ring Buffer</td><td>Logging/Metrics</td><td>Bound infinite</td></tr>
                                <tr><td>8</td><td>Distributed Log</td><td>Kafka/Streaming</td><td>Scale it all</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <p style="margin-top: 20px; font-size: 0.8em;">
                        <strong>THEME:</strong> Store â†’ Navigate â†’ Preserve â†’ Forget â†’ Distribute â†’ Bound
                    </p>
                </section>

                <!-- SLIDE 20: ACHIEVEMENTS -->
                <section>
                    <h2>ğŸ† Season 1 Complete</h2>
                    <div style="font-size: 0.8em;">
                        <div class="achievement">âœ… See linked lists hidden in production systems</div>
                        <div class="achievement">âœ… Choose the right data structure for time-based problems</div>
                        <div class="achievement">âœ… Design caches with appropriate eviction policies</div>
                        <div class="achievement">âœ… Distribute data across servers with minimal disruption</div>
                        <div class="achievement">âœ… Handle infinite streams with bounded memory</div>
                        <div class="achievement">âœ… Make backpressure decisions based on data criticality</div>
                        <div class="achievement">âœ… Connect LeetCode problems to real-world systems</div>
                    </div>
                    <div class="key-insight fragment" style="margin-top: 20px;">
                        You don't just pass interviews. You build better systems.
                    </div>
                </section>

                <!-- SLIDE 21: SEASON 2 PREVIEW -->
                <section>
                    <h2>ğŸŒ² Coming in Season 2</h2>
                    <h3 class="text-green">The Invisible Forest</h3>
                    <div class="success-box" style="font-size: 0.85em;">
                        <p style="margin-bottom: 20px;">We mastered <strong>LINEAR</strong> time.<br>Real systems are <strong>MULTI-DIMENSIONAL</strong>.</p>
                        <div class="comparison-grid" style="font-size: 0.9em;">
                            <div>ğŸŒ² Binary Search Trees â†’ Database Indexes</div>
                            <div>ğŸ”´ Red-Black Trees â†’ Linux Scheduler</div>
                            <div>ğŸ“ B-Trees â†’ Filesystem Design</div>
                            <div>ğŸ”¤ Tries â†’ Autocomplete</div>
                            <div>ğŸ“Š Graphs â†’ Social Networks</div>
                            <div>ğŸŒ¸ Bloom Filters â†’ Distributed Dedup</div>
                        </div>
                    </div>
                    <p class="fragment" style="margin-top: 30px; font-size: 1.1em;">
                        Trees branch. Graphs connect.<br>
                        <span class="text-green">Season 2 reveals the forest.</span>
                    </p>
                </section>

                <!-- SLIDE 22: CLOSING -->
                <section>
                    <div style="max-width: 800px; margin: 0 auto;">
                        <p style="font-size: 1.1em; line-height: 1.8; font-style: italic;">
                            "Data structures aren't abstract concepts.<br><br>
                            They're the invisible foundations<br>
                            of every digital system you use.<br><br>
                            Git, browsers, caches, Kafkaâ€”<br>
                            all built on what you learned this season.<br><br>
                            Master them, and you don't just pass interviews.<br>
                            <span class="text-green">You build better systems.</span>"
                        </p>
                    </div>
                    <div style="margin-top: 50px;">
                        <p style="font-size: 0.8em; color: #888;">
                            ğŸ”— Code repository &nbsp;&nbsp; ğŸ“ Practice problems &nbsp;&nbsp; ğŸ’¬ Community
                        </p>
                        <p style="margin-top: 30px; font-size: 1.2em;">
                            Thank you for watching Season 1.<br>
                            <span class="text-purple">See you in the forest. ğŸŒ²</span>
                        </p>
                    </div>
                    <div style="margin-top: 40px;">
                        <span class="badge badge-finale">END OF SEASON 1</span>
                    </div>
                </section>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/plugin/highlight/highlight.min.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: 'c/t',
            showSlideNumber: 'all',
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            plugins: [ RevealHighlight ],
            width: 1200,
            height: 700,
            margin: 0.1,
        });
    </script>
</body>
</html>
